package dev.tenacity.module.impl.exploit;

import dev.tenacity.event.annotations.EventTarget;
import dev.tenacity.event.impl.network.PacketEvent;
import dev.tenacity.module.Category;
import dev.tenacity.module.Module;
import net.minecraft.network.play.server.S02PacketChat;

public final class TPAKiller extends Module {

    public TPAKiller() {
        super("module.exploit.TPAKiller", Category.EXPLOIT, "Suffocates people who /tpa to you");
    }

    @EventTarget
    public void onPacketEvent(PacketEvent event) {
        if (event.getPacket() instanceof S02PacketChat s02PacketChat && mc.thePlayer != null) {
            String msg = s02PacketChat.getChatComponent().getUnformattedText();
            if (msg.contains("tpa") || msg.contains("request")) {
                mc.thePlayer.setPosition(mc.thePlayer.posX, mc.thePlayer.posY - 6, mc.thePlayer.posZ);
                mc.thePlayer.sendChatMessage("/tpa accept");
                if (mc.thePlayer.ticksExisted % 2 == 0) {
                    mc.thePlayer.setPosition(mc.thePlayer.posX, mc.thePlayer.posY + 6, mc.thePlayer.posZ);
                }
            }
        }
    }

}
